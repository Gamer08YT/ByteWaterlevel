<!doctypehtml><html lang=de data-theme=light><meta charset=UTF-8><meta name=viewport content="width=device-width,initial-scale=1"><title>BYTELEVEL</title><script src=https://cdn.jsdelivr.net/npm/chart.js></script><style>:root{--primary:#007AFF;--success:#34C759;--bg-gradient-1:#4facfe;--bg-gradient-2:#00f2fe;--glass-bg:rgba(255, 255, 255, 0.65);--glass-border:rgba(255, 255, 255, 0.5);--text-color:#1d1d1f;--text-secondary:#86868b;--input-bg:rgba(255, 255, 255, 0.5);--card-shadow:0 8px 32px 0 rgba(31, 38, 135, 0.15)}.flex{display:flex}[data-theme=dark]{--bg-gradient-1:#0f2027;--bg-gradient-2:#203a43;--glass-bg:rgba(28, 28, 30, 0.65);--glass-border:rgba(255, 255, 255, 0.1);--text-color:#f5f5f7;--text-secondary:#a1a1a6;--input-bg:rgba(0, 0, 0, 0.3);--card-shadow:0 8px 32px 0 rgba(0, 0, 0, 0.3)}*{box-sizing:border-box;transition:background-color .3s,color .3s}html{height:100%}.tab-container::-webkit-scrollbar{width:8px}.tab-container::-webkit-scrollbar-track{background:0 0}[data-theme=dark] .tab-container::-webkit-scrollbar-thumb{background-color:rgba(255,255,255,.25)}[data-theme=light] .tab-container::-webkit-scrollbar-thumb{background-color:rgba(0,0,0,.25)}.tab-container::-webkit-scrollbar-thumb{background-color:rgba(255,255,255,.25);border-radius:10px;border:2px solid transparent;background-clip:padding-box}.tab-container::-webkit-scrollbar-thumb:hover{background-color:rgba(255,255,255,.45)}body{padding-top:5rem;padding-bottom:5rem;overflow:hidden;margin:0;font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Helvetica,Arial,sans-serif;background:linear-gradient(135deg,var(--bg-gradient-1),var(--bg-gradient-2));height:100%;display:flex;justify-content:center;align-items:center;color:var(--text-color);overflow-x:hidden}.orb{position:absolute;border-radius:50%;filter:blur(80px);z-index:-1;animation:float 10s infinite ease-in-out}.orb-1{width:300px;height:300px;background:#ff0080;top:-50px;left:-50px;opacity:.4}.orb-2{width:400px;height:400px;background:#7928ca;bottom:-100px;right:-100px;opacity:.4;animation-delay:-5s}@keyframes float{0%,100%{transform:translate(0,0)}50%{transform:translate(30px,50px)}}#connection{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);font-size:1.2rem;font-weight:600;z-index:999;color:var(--text-color);background-color:red;padding:1rem;border-radius:1.65rem;display:none}.app-container{width:100%;max-width:45rem;height:100%;background:var(--glass-bg);backdrop-filter:blur(20px) saturate(180%);-webkit-backdrop-filter:blur(20px) saturate(180%);border:1px solid var(--glass-border);border-radius:24px;box-shadow:var(--card-shadow);padding:30px;display:flex;flex-direction:column}.app-container[disabled=disabled]{filter:blur(5px)}header{display:flex;justify-content:space-between;align-items:center;margin-bottom:20px}h1{margin:0;font-weight:700;font-size:1.5rem;letter-spacing:-.5px}.theme-toggle{background:0 0;border:none;cursor:pointer;padding:8px;border-radius:50%;background:var(--input-bg);display:flex;align-items:center;justify-content:center}.theme-icon{width:24px;height:24px;fill:var(--text-color);transition:transform .5s cubic-bezier(.68, -.55, .27, 1.55)}.tabs{display:flex;background:var(--input-bg);padding:4px;border-radius:12px;margin-bottom:30px}.tab-btn{flex:1;padding:10px;border:none;background:0 0;color:var(--text-secondary);font-weight:600;cursor:pointer;border-radius:8px;transition:all .2s}.tab-btn.active{background:var(--glass-bg);color:var(--text-color);box-shadow:0 2px 8px rgba(0,0,0,.1)}.tab-content{overflow:hidden;height:100%;display:none;animation:fadeIn .4s ease}.tab-container{height:100%;overflow-y:scroll}.tab-content.active{display:block}@keyframes fadeIn{from{opacity:0;transform:translateY(10px)}to{opacity:1;transform:translateY(0)}}.group-title{text-transform:uppercase;font-size:.75rem;color:var(--text-secondary);margin-bottom:10px;margin-top:20px;font-weight:600}.control-group{background:var(--input-bg);border-radius:16px;padding:15px 20px;margin-bottom:20px}.control-row{display:flex;justify-content:space-between;align-items:center;padding:12px 0;border-bottom:1px solid var(--glass-border)}.control-row:last-child{border-bottom:none}label{font-weight:500}input[type=number],input[type=password],input[type=text]{background:0 0;border:1px solid transparent;text-align:right;color:var(--primary);font-size:1rem;outline:0;width:60%}input:focus{border-bottom:1px solid var(--primary)}.switch{position:relative;display:inline-block;width:50px;height:30px}.switch input{opacity:0;width:0;height:0}.slider{position:absolute;cursor:pointer;top:0;left:0;right:0;bottom:0;background-color:rgba(120,120,128,.3);transition:.4s;border-radius:34px}.slider:before{position:absolute;content:"";height:26px;width:26px;left:2px;bottom:2px;background-color:#fff;transition:.4s;border-radius:50%;box-shadow:0 2px 4px rgba(0,0,0,.2)}input:checked+.slider{background-color:var(--success)}input:checked+.slider:before{transform:translateX(20px)}.btn-save{width:100%;padding:15px;font-size:1rem;font-weight:600;cursor:pointer;margin-top:20px}.btn-save,.btn-update{border-radius:.8rem;background-color:var(--primary);color:#fff;border:none}.btn-update{padding:5px;margin-left:.5rem}.btn-save:hover,.btn-update:hover{opacity:.9}.chart-container{background:var(--input-bg);border-radius:16px;padding:15px;margin-bottom:20px;height:300px}</style><div class="orb orb-1"></div><div class="orb orb-2"></div><div id=connection>Lost connection, please wait or try again later.</div><div class=app-container><header><h1 style=font-weight:lighter><b>BYTE</b>LEVEL</h1><button class=theme-toggle id=themeSwitcher aria-label="Toggle Dark Mode"><svg class=theme-icon id=iconSun viewBox="0 0 24 24"style=display:none><path d="M12 7c-2.76 0-5 2.24-5 5s2.24 5 5 5 5-2.24 5-5-2.24-5-5-5zM2 13h2c.55 0 1-.45 1-1s-.45-1-1-1H2c-.55 0-1 .45-1 1s.45 1 1 1zm18 0h2c.55 0 1-.45 1-1s-.45-1-1-1h-2c-.55 0-1 .45-1 1s.45 1 1 1zM11 2v2c0 .55.45 1 1 1s1-.45 1-1V2c0-.55-.45-1-1-1s-1 .45-1 1zm0 18v2c0 .55.45 1 1 1s1-.45 1-1v-2c0-.55-.45-1-1-1s-1 .45-1 1zM5.99 4.58a.996.996 0 00-1.41 0 .996.996 0 000 1.41l1.29 1.29c.19.19.45.29.71.29s.51-.1.71-.29a.996.996 0 000-1.41L5.99 4.58zm12.37 12.37a.996.996 0 00-1.41 0 .996.996 0 000 1.41l1.29 1.29c.19.19.45.29.71.29s.51-.1.71-.29a.996.996 0 000-1.41l-1.29-1.29zm-1.29-11.08c.39-.39 1.03-.39 1.41 0l1.29 1.29a.996.996 0 010 1.41c-.39.39-1.03.39-1.41 0L16.07 7.28a.996.996 0 010-1.41zm-10.49 10.49c.39-.39 1.03-.39 1.41 0l1.29 1.29a.996.996 0 010 1.41c-.39.39-1.03.39-1.41 0l-1.29-1.29a.996.996 0 010-1.41z"></path></svg><svg class=theme-icon id=iconMoon viewBox="0 0 24 24"><path d="M12 3c-4.97 0-9 4.03-9 9s4.03 9 9 9 9-4.03 9-9c0-.46-.04-.92-.1-1.36-.98 1.37-2.58 2.26-4.4 2.26-3.03 0-5.5-2.47-5.5-5.5 0-1.82.89-3.42 2.26-4.4-.44-.06-.9-.1-1.36-.1z"></path></svg></button></header><div class=tabs><button class="tab-btn active"onclick='openTab("status")'>Status</button><button class=tab-btn onclick='openTab("config")'>Configuration</button><button class=tab-btn onclick='openTab("system")'>System</button></div><div id=status class="tab-content active"><div class=group-title>TL136 Sensor</div><div class=chart-container><canvas id=adcChart></canvas></div><div class=group-title>Control</div><div class=control-group><div class=control-row><label for=relay1>Channel 1</label><label class=switch><input type=checkbox id=relay1><span class=slider></span></label></div><div class=control-row><label for=relay2>Channel 2</label><label class=switch><input type=checkbox id=relay2><span class=slider></span></label></div></div></div><div id=config class=tab-content><div class=tab-container><div class=group-title>WiFi Settings</div><div class=control-group><div class=control-row><label>SSID</label><input id=cssid></div><div class=control-row><label>Password</label><input id=cpw type=password></div></div><div class=group-title>Access Point (Fallback)</div><div class=control-group><div class=control-row><label>AP SSID</label><input id=assid></div><div class=control-row><label>AP Password</label><input id=apw type=password></div></div><div class=group-title>Caliration</div><div class=control-group><div class=control-row><label>Min. Voltage</label><input id=minv type=number></div><div class=control-row><label>Max. Voltage</label><input id=maxv type=number></div><div class=control-row><label>Tank Volume</label><input id=tv type=number></div></div><div class=group-title>MQTT Broker</div><div class=control-group><div class=control-row><label>Enable MQTT</label><label class=switch><input id=men type=checkbox><span class=slider></span></label></div><div class=control-row><label>Server</label><input id=mhost></div><div class=control-row><label>Port</label><input id=mport type=number value=1883></div><div class=control-row><label>User</label><input id=muser></div><div class=control-row><label>Password</label><input id=mpw type=password></div></div><button onclick=save(1) class=btn-save>Save</button></div></div><div id=system class=tab-content><div class=tab-container><div class=group-title>Device Settings</div><div class=control-group><div class=control-row><label>System LED</label><label class=switch><input id=led type=checkbox><span class=slider></span></label></div><div class=control-row><label>OTA</label><label class=switch><input id=ota type=checkbox><span class=slider></span></label></div><div class=control-row><label>Debug Log Level</label><input value=INFO readonly style=opacity:.5></div></div><div class=group-title>WebGUI Security</div><div class=control-group><div class=control-row><label>Enable Auth</label><label class=switch><input id=auth type=checkbox><span class=slider></span></label></div><div class=control-row><label>Admin User</label><input id=user></div><div class=control-row><label>New Password</label><input id=pw type=password></div></div><div class=group-title>Info</div><div class=control-group><div class=control-row><label>Firmware</label><div class=flex><span id=firmware></span><button style=display:none onclick=aupdate() id=update class=btn-update>Update</button></div></div><div class=control-row><label>Uptime</label><div class=flex><span id=up></span><button class=btn-update onclick=arestart() style=background-color:green>Restart</button></div></div><div class=control-row><label>CPU Temp.</label><span id=temperature></span></div><div class=control-row><label>CPU Freq.</label><span id=frequency></span></div></div><button onclick=save(2) class=btn-save>Save</button></div></div></div><script>let inFlight=!1;function setChecked(t,e){const n=document.getElementById(t);n&&(n.checked=Boolean(e))}function setRelayChecked(t,e){setChecked(`relay${t}`,e)}function formatUptime(t){const e=Math.floor(t/86400);t%=86400;const n=Math.floor(t/3600);t%=3600;const a=[["d",e],["h",n],["min",Math.floor(t/60)],["s",t%=60]],o=a.findIndex((([,t])=>t>0));return-1===o?"0s":a.slice(o).filter((([,t])=>t>0)).map((([t,e])=>`${e}${t}`)).join(" ")}function startStatusPing(){setInterval((async()=>{if(!inFlight){inFlight=!0;try{const t=await fetch("/api",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({type:"status"})}),e=await t.json();void 0!==e.channels&&(setRelayChecked(1,e.channels[0]),setRelayChecked(2,e.channels[1])),document.getElementById("temperature").textContent=e.cpu+"Â°C",document.getElementById("frequency").textContent=e.frequency+" MHz",document.getElementById("up").textContent=formatUptime(e.up);const n=window.myChart.data.datasets[0].data,a=window.myChart.data.datasets[1].data,o=window.myChart.data.labels;n.shift(),n.push(e.adc),a.shift(),a.push(e.current),o.shift(),o.push((new Date).toLocaleTimeString()),window.myChart.update("none")}catch(t){}finally{inFlight=!1}}}),1e3)}async function postRelayState(t,e){const n={type:"relais",channel:t,state:!!e},a=await fetch("/api",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)});if(!a.ok){const t=await a.text().catch((()=>""));throw new Error(`API Fehler: HTTP ${a.status} ${t}`)}return!0}function wireRelayToggle(t,e){const n=document.getElementById(t);n&&n.addEventListener("change",(async t=>{const n=t.target.checked;try{await postRelayState(e,n)}catch(e){console.error(e),t.target.checked=!n}}))}function setValue(t,e){document.getElementById(t).value=e}function setText(t,e){document.getElementById(t).textContent=e}function setOffline(t){console.log("Offline: "+t),document.getElementById("connection").style.display=t?"block":"none"}async function getInfo(){try{const t=await fetch("/api",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({type:"info"})}),e=await t.json();if("success"==e.type){const t=e.config;window.configESP=t,setValue("user",t.admin.user),setValue("pw",t.admin.password),setChecked("auth",t.admin.state),setChecked("led",t.hardware.led),setChecked("ota",t.ota),setValue("assid",t.wifi.ap.ssid),setValue("apw",t.wifi.ap.password),setValue("cssid",t.wifi.client.ssid),setValue("cpw",t.wifi.client.password),setValue("maxv",t.calibration.max),setValue("minv",t.calibration.min),setValue("tv",t.calibration.volume),setValue("mhost",t.mqtt.host),setValue("muser",t.mqtt.user),setValue("mport",t.mqtt.port),setValue("mpw",t.mqtt.password),setChecked("men",t.mqtt.state),document.getElementById("update").style.display=e.update?"block":"none",setText("firmware",e.firmware)}setOffline(!1)}catch(t){setOffline(!0)}}function val(t){return document.getElementById(t).value}function arestart(){confirm("Are you sure?")&&restart()}function restart(){fetch("/api",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({type:"restart"})})}function aupdate(){confirm("Are you sure?")&&update()}function update(){fetch("/api",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({type:"update"})})}async function save(t){console.log(window.configESP),1===t&&(window.configESP.wifi.ap.ssid=val("assid"),window.configESP.wifi.ap.password=val("apw"),window.configESP.wifi.client.ssid=val("cssid"),window.configESP.wifi.client.password=val("cpw"),window.configESP.calibration.max=val("maxv"),window.configESP.calibration.min=val("minv"),window.configESP.calibration.volume=val("tv"),window.configESP.mqtt.host=val("mhost"),window.configESP.mqtt.port=val("mport"),window.configESP.mqtt.user=val("muser"),window.configESP.mqtt.password=val("mpw"),window.configESP.mqtt.state=document.getElementById("men").checked),2===t&&(window.configESP.admin.user=val("user"),window.configESP.admin.password=val("pw"),window.configESP.admin.state=document.getElementById("auth").checked,window.configESP.hardware.led=document.getElementById("led").checked,window.configESP.ota=document.getElementById("ota").checked),console.log("Save",window.configESP),await fetch("/api",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({type:"save",config:window.configESP})}).then((t=>{confirm("Saved, restart Device now?")&&restart()})).catch((t=>alert("Error saving: "+t)))}startStatusPing(),document.addEventListener("DOMContentLoaded",(()=>{wireRelayToggle("relay1",1),wireRelayToggle("relay2",2),getInfo()}))</script><script>function openTab(t){document.querySelectorAll(".tab-content").forEach((t=>t.classList.remove("active"))),document.querySelectorAll(".tab-btn").forEach((t=>t.classList.remove("active"))),document.getElementById(t).classList.add("active");const e=document.querySelectorAll(".tab-btn");"status"===t&&e[0].classList.add("active"),"config"===t&&e[1].classList.add("active"),"system"===t&&e[2].classList.add("active")}const themeBtn=document.getElementById("themeSwitcher"),iconSun=document.getElementById("iconSun"),iconMoon=document.getElementById("iconMoon"),html=document.documentElement;function setDark(t){t?(html.setAttribute("data-theme","dark"),iconSun.style.display="block",iconMoon.style.display="none",window.myChart&&(window.myChart.options.scales.x.grid.color="rgba(255,255,255,0.1)",window.myChart.options.scales.y.grid.color="rgba(255,255,255,0.1)",window.myChart.update())):(html.setAttribute("data-theme","light"),iconSun.style.display="none",iconMoon.style.display="block",window.myChart&&(window.myChart.options.scales.x.grid.color="rgba(0,0,0,0.05)",window.myChart.options.scales.y.grid.color="rgba(0,0,0,0.05)",window.myChart.update()))}window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?setDark(!0):setDark(!1),themeBtn.addEventListener("click",(()=>{setDark(!("dark"===html.getAttribute("data-theme")))}));const ctx=document.getElementById("adcChart").getContext("2d"),initialData=Array.from({length:20},(()=>.5*Math.random()+1.2)),initialCurrent=Array.from({length:20},(()=>.5*Math.random()+.5)),labels=Array.from({length:20},((t,e)=>e));let gradient=ctx.createLinearGradient(0,0,0,400);gradient.addColorStop(0,"rgba(0, 122, 255, 0.5)"),gradient.addColorStop(1,"rgba(0, 122, 255, 0.0)"),window.myChart=new Chart(ctx,{type:"line",data:{labels:labels,datasets:[{label:"Spannung (V)",data:initialData,borderColor:"#007AFF",backgroundColor:gradient,borderWidth:2,pointRadius:0,pointHoverRadius:4,fill:!0,tension:.4},{label:"Strom (mA)",data:initialCurrent,borderColor:"#007AFF",backgroundColor:gradient,borderWidth:2,pointRadius:0,pointHoverRadius:4,fill:!0,tension:.4}]},options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{display:!1},tooltip:{mode:"index",intersect:!1,backgroundColor:"rgba(0,0,0,0.7)",titleColor:"#fff",bodyColor:"#fff"}},scales:{x:{display:!1,grid:{color:"rgba(0,0,0,0.05)"}},y:{min:0,max:3.3,grid:{color:"rgba(0,0,0,0.05)"},ticks:{callback:function(t){return t+" V"},color:"#86868b"}}},animation:{duration:0}}})</script>